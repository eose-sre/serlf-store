<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>serlf — Sign In</title>
<script src="https://accounts.google.com/gsi/client" async defer></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
:root {
  --bg: #060610;
  --surface: #0c0c1a;
  --border: #1a1a3e;
  --text: #e8e8f0;
  --muted: #6b6b8d;
  --green: #34d399;
  --blue: #60a5fa;
  --red: #ef4444;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: var(--bg); color: var(--text); font-family: 'Inter', -apple-system, system-ui, sans-serif; min-height: 100vh; display: flex; align-items: center; justify-content: center; }

.login-container { width: 100%; max-width: 420px; padding: 20px; }

.logo { text-align: center; margin-bottom: 40px; }
.logo h1 { font-size: 36px; font-weight: 700; color: var(--green); }
.logo p { color: var(--muted); font-size: 14px; margin-top: 8px; }

.login-box {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 36px 32px;
}

.login-box h2 { font-size: 20px; font-weight: 600; margin-bottom: 24px; text-align: center; }

.google-btn-wrap {
  display: flex;
  justify-content: center;
  margin-bottom: 8px;
}

.divider {
  text-align: center; color: var(--muted); font-size: 12px; margin: 24px 0; position: relative;
}
.divider::before, .divider::after {
  content: ''; position: absolute; top: 50%; width: 40%; height: 1px; background: var(--border);
}
.divider::before { left: 0; }
.divider::after { right: 0; }

.form-group { margin-bottom: 20px; }
.form-group label { display: block; font-size: 13px; color: var(--muted); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 1px; }
.form-group input {
  width: 100%; padding: 14px 16px; background: var(--bg); border: 1px solid var(--border);
  border-radius: 10px; color: var(--text); font-size: 16px; font-family: inherit; outline: none; transition: border-color 0.2s;
}
.form-group input:focus { border-color: var(--green); }

.error-msg { color: var(--red); font-size: 13px; margin-top: 8px; display: none; text-align: center; }

.btn-signin {
  width: 100%; padding: 14px; background: linear-gradient(135deg, var(--green), var(--blue));
  color: var(--bg); font-size: 16px; font-weight: 700; border: none; border-radius: 10px;
  cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; margin-top: 8px;
}
.btn-signin:hover { transform: translateY(-1px); box-shadow: 0 6px 20px rgba(52, 211, 153, 0.3); }

.signup-link { text-align: center; margin-top: 24px; font-size: 14px; color: var(--muted); }
.signup-link a { color: var(--green); text-decoration: none; font-weight: 600; }

.back-link { text-align: center; margin-top: 16px; }
.back-link a { color: var(--muted); font-size: 13px; text-decoration: none; }
.back-link a:hover { color: var(--text); }

.welcome-msg {
  text-align: center; padding: 16px; background: rgba(52,211,153,0.08);
  border: 1px solid rgba(52,211,153,0.2); border-radius: 10px; margin-bottom: 20px; display: none;
}
.welcome-msg .email { color: var(--green); font-weight: 600; }
</style>
</head>
<body>

<div class="login-container">
  <div class="logo">
    <h1>serlf</h1>
    <p>Sign in to your digital world</p>
  </div>

  <div class="login-box">
    <h2>Welcome back</h2>

    <div class="welcome-msg" id="welcome-msg">
      ✅ Signed in as <span class="email" id="user-email"></span>
    </div>

    <!-- Google One Tap / Button -->
    <div class="google-btn-wrap">
      <div id="g_id_onload"
        data-client_id="758788284456-vf6gmi5a8gkbr1oqu2ohol3p3i7m9s8e.apps.googleusercontent.com"
        data-callback="handleGoogleSignIn"
        data-auto_prompt="true"
        data-context="signin">
      </div>
      <div class="g_id_signin"
        data-type="standard"
        data-shape="rectangular"
        data-theme="filled_black"
        data-text="signin_with"
        data-size="large"
        data-logo_alignment="left"
        data-width="356">
      </div>
    </div>

    <div class="divider">or</div>

    <form onsubmit="emailSignIn(event)">
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="email" placeholder="you@example.com" required>
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="password" placeholder="••••••••" required>
      </div>
      <div class="error-msg" id="error">Invalid email or password</div>
      <button type="submit" class="btn-signin">Sign In</button>
    </form>

    <div class="signup-link">
      Don't have an account? <a href="https://buy.stripe.com/fZufZbgo3cxr0Li9ZAgjC03">Get started — $1/month</a>
    </div>
  </div>

  <div class="back-link">
    <a href="index.html">← Back to serlf.ca</a>
  </div>
</div>

<script>
var SERLF_AUTH_KEY = 'serlf_auth';

function setAuth(email, name, picture) {
  var auth = {
    email: email,
    name: name || '',
    picture: picture || '',
    ts: Date.now(),
    expires: Date.now() + (30 * 24 * 60 * 60 * 1000), // 30 days
    provider: name ? 'google' : 'email'
  };
  localStorage.setItem(SERLF_AUTH_KEY, JSON.stringify(auth));
}

function getAuth() {
  try {
    var auth = JSON.parse(localStorage.getItem(SERLF_AUTH_KEY));
    if (auth && auth.expires > Date.now()) return auth;
    localStorage.removeItem(SERLF_AUTH_KEY);
  } catch(e) {}
  return null;
}

// If already logged in, go to dashboard
var existing = getAuth();
if (existing) {
  window.location.href = 'dashboard.html';
}

// Google Sign-In callback
function handleGoogleSignIn(response) {
  // Decode JWT to get user info
  var payload = JSON.parse(atob(response.credential.split('.')[1]));
  setAuth(payload.email, payload.name, payload.picture);
  window.location.href = 'dashboard.html';
}

// Email/password sign in
function emailSignIn(e) {
  e.preventDefault();
  var email = document.getElementById('email').value;
  var password = document.getElementById('password').value;
  
  if (email && password.length >= 4) {
    setAuth(email);
    window.location.href = 'dashboard.html';
  } else {
    document.getElementById('error').style.display = 'block';
  }
}
</script>

</body>
</html>
